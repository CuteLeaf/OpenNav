{% extends "base.html" %} {% block content %}
<div class="container">
  <div class="row">
    <div class="col-md-3">
      <div class="admin-sidebar mb-4">
        <h5 class="mb-3">管理菜单</h5>
        <a href="{{ url_for('admin.index') }}" class="admin-sidebar-item">
          <i class="bi bi-speedometer2"></i> 仪表盘
        </a>
        <a
          href="{{ url_for('admin.categories') }}"
          class="admin-sidebar-item active"
        >
          <i class="bi bi-folder"></i> 分类管理
        </a>
        <a href="{{ url_for('admin.websites') }}" class="admin-sidebar-item">
          <i class="bi bi-globe"></i> 网站管理
        </a>
        <a href="{{ url_for('admin.invitations') }}" class="admin-sidebar-item">
          <i class="bi bi-envelope"></i> 邀请码
        </a>
        <a href="{{ url_for('admin.users') }}" class="admin-sidebar-item">
          <i class="bi bi-people"></i> 用户管理
        </a>
        <hr />
        <a href="{{ url_for('main.index') }}" class="admin-sidebar-item">
          <i class="bi bi-arrow-left"></i> 返回前台
        </a>
      </div>
    </div>
    <div class="col-md-9">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="bi bi-folder"></i> 分类管理</h2>
        <a href="{{ url_for('admin.add_category') }}" class="btn btn-primary">
          <i class="bi bi-plus-circle"></i> 添加分类
        </a>
      </div>

      <div class="card">
        <div class="card-body">
          {% if categories %}
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>排序</th>
                  <th>名称</th>
                  <th>描述</th>
                  <th>网站数</th>
                  <th>首页展示数量</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody>
                {% for category in categories %}
                <tr>
                  <td>{{ category.order }}</td>
                  <td>
                    <div class="d-flex align-items-center">
                      <div
                        class="me-2"
                        style="width: 30px; height: 30px; text-align: center; line-height: 30px; border-radius: 6px; background-color: {{ category.color or '#3498db' }}; color: white;"
                      >
                        {% if category.icon %}
                        <i class="bi bi-{{ category.icon }}"></i>
                        {% else %}
                        <i class="bi bi-folder"></i>
                        {% endif %}
                      </div>
                      {{ category.name }}
                    </div>
                  </td>
                  <td>{{ category.description|truncate(30) }}</td>
                  <td>{{ category.websites.count() }}</td>
                  <td>{{ category.display_limit }}</td>
                  <td>
                    <a
                      href="{{ url_for('admin.edit_category', id=category.id) }}"
                      class="btn btn-sm btn-outline-primary"
                    >
                      <i class="bi bi-pencil"></i>
                    </a>
                    <a
                      href="{{ url_for('admin.delete_category', id=category.id) }}"
                      class="btn btn-sm btn-outline-danger"
                      onclick="return confirm('确定要删除此分类吗？')"
                    >
                      <i class="bi bi-trash"></i>
                    </a>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          {% else %}
          <div class="text-center py-5">
            <i class="bi bi-emoji-frown fs-1 text-muted"></i>
            <p class="mt-3 text-muted">暂无分类数据</p>
            <a
              href="{{ url_for('admin.add_category') }}"
              class="btn btn-primary mt-2"
            >
              <i class="bi bi-plus-circle"></i> 添加第一个分类
            </a>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
