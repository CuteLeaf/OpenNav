{% extends "admin/base.html" %} {% block admin_content %}
<div class="container-fluid px-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="mt-4">{{ "添加用户" if not user else "编辑用户" }}</h1>
    <div>
      {% if user %}
      <a
        href="{{ url_for('admin.user_detail', id=user.id) }}"
        class="btn btn-outline-secondary me-2"
      >
        <i class="bi bi-eye"></i> 查看详情
      </a>
      {% endif %}
      <a href="{{ url_for('admin.users') }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> 返回
      </a>
    </div>
  </div>

  <div class="card mb-4">
    <div class="card-header">
      <i class="bi bi-person-gear"></i>
      用户信息
    </div>
    <div class="card-body">
      <form method="post">
        {{ form.hidden_tag() }}

        <div class="mb-3">
          {{ form.username.label(class="form-label") }} {{
          form.username(class="form-control") }} {% if form.username.errors %}
          {% for error in form.username.errors %}
          <div class="text-danger">{{ error }}</div>
          {% endfor %} {% endif %}
        </div>

        <div class="mb-3">
          {{ form.email.label(class="form-label") }} {{
          form.email(class="form-control") }} {% if form.email.errors %} {% for
          error in form.email.errors %}
          <div class="text-danger">{{ error }}</div>
          {% endfor %} {% endif %}
        </div>

        <div class="mb-3">
          {{ form.password.label(class="form-label") }} {{
          form.password(class="form-control") }} {% if form.password.errors %}
          {% for error in form.password.errors %}
          <div class="text-danger">{{ error }}</div>
          {% endfor %} {% endif %}
          <div class="form-text">如果不想修改密码，请留空</div>
        </div>

        <div class="mb-3 form-check">
          {{ form.is_admin(class="form-check-input") }} {{
          form.is_admin.label(class="form-check-label") }}
        </div>

        {% if current_user.is_superadmin %}
        <div class="mb-3 form-check">
          {{ form.is_superadmin(class="form-check-input") }} {{
          form.is_superadmin.label(class="form-check-label") }}
        </div>
        {% endif %}

        <div class="form-group mt-4">
          {{ form.submit_btn(class="btn btn-primary") }}
          <a href="{{ url_for('admin.users') }}" class="btn btn-secondary"
            >取消</a
          >
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
